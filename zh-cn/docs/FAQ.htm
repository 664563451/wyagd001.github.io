<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>AutoHotkey FAQ</title>
<link href="static/theme.css" rel="stylesheet" type="text/css" />
<script src="static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>常见问题(FAQ)</h1>

<h3>语言语法</h3>
<ul>
  <li><a href="#quotes">什么时候需要在命令和它们的参数中使用引号?</a></li>
  <li><a href="#percent">什么时候需要将变量名括在百分号中?</a></li>
  <li><a href="#esc">什么时候应该对百分号和逗号进行转义?</a></li>
</ul>
<h3>一般故障排查</h3>
<ul>
  <li><a href="#install">如果 AutoHotkey 无法安装我该怎么办?</a></li>
  <li><a href="#autoexec">为什么我脚本中的某些行总是无法执行?</a></li>
  <li><a href="#vista">为什么我的脚本在前一个系统运行良好却无法工作于 Windows <em>xxx</em> ?</a></li>
  <li><a href="#uac">我该如何处理用户账户控制 (UAC) 导致的问题?</a></li>
  <li><a href="#DefaultScript">我想通过托盘图标编辑脚本,但它只显示一个错误. 能在其他位置找到我的脚本吗?</a></li>
  <li><a href="#Debug">如何查找代码中的错误并修改呢?</a></li>
  <li><a href="#run">为什么 Run 命令不能启动我的游戏或程序?</a></li>
  <li><a href="#games">为什么在某些游戏中热字串, Send 和 MouseClick 不起作用?</a></li>
  <li><a href="#perf">如何在玩游戏或平时 CPU 高负荷运行时改善性能?</a></li>
  <li><a href="#Virus">我的杀毒软件把 AHK 归为恶意软件. 它真的含病毒吗?</a></li>
</ul>
<h3>常见任务</h3>
<ul>
  <li><a href="#Download">我可以在哪里找到官方发行版或更旧的版本?</a></li>
  <li><a href="#USB">可以在 USB 驱动器中运行 AHK 代码吗?</a></li>
  <li><a href="#output">如何获取命令行操作的输出?</a></li>
  <li><a href="#close">如何让一个脚本关闭, 暂停或挂起其他的脚本?</a></li>
  <li><a href="#repeat">如何在不退出脚本的情况下停止重复的动作?</a></li>
  <li><a href="#help">如何在任意编辑器中获取上下文相关的 AutoHotkey 命令帮助?</a></li>
  <li><a href="#load">如何检测一个网页何时加载完毕?</a></li>
  <li><a href="#time">如何比较或操作日期与时间?</a></li>
  <li><a href="#SendDate">如何发送当前的日期和时间?</a></li>
  <li><a href="#ControlSend">如何发送文本到不活跃或隐藏的窗口?</a></li>
  <li><a href="#winamp">如何控制 Winamp, 即使在它未激活时?</a></li>
  <li><a href="#msgbox">如何改变 MsgBox 的按钮名称?</a></li>
  <li><a href="#DefaultEditor">如何改变默认编辑器,即通过上下文菜单或托盘图标打开的那个?</a></li>
  <li><a href="#GuiSubmit">如何保存 GUI 关联变量的内容?</a></li>
  <li><a href="#GDIPlus">如何用 AHK 描绘?</a></li>
  <li><a href="#WinWaitAction">如何在窗口出现,关闭或变成(不)活跃时执行操作?</a></li>
</ul>
<h3>热键, 热字串和重映射</h3>
<ul>
  <li><a href="#Startup">如何让我的热键和热字串在 PC 启动时自动生效?</a></li>
  <li><a href="#HotMouse">我在把鼠标按钮作为热键使用时遇到问题. 能提供一些建议吗?</a></li>
  <li><a href="#HotSymb">如何将 tab 和空格设置为热键?</a></li>
  <li><a href="#Remap">如何将按键或鼠标按钮重映射成其他键?</a></li>
  <li><a href="#DoublePress">如何检测按键或按钮的双击?</a></li>
  <li><a href="#HotContext">如何让热键或热字串只在特定的程序中有效? 换句话说, 在特定的窗口不活动时我想让特定的按键执行它原来的功能.</a></li>
  <li><a href="#HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</a></li>
  <li><a href="#HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U (辅助工具管理器) 和 Win+R (运行)?</a></li>
  <li><a href="#HotRegex">如何在热字串中使用通配符或正则表达式?</a></li>
  <li><a href="#SpecialKey">如何使用不存在于我键盘布局中的热键?</a></li>
  <li><a href="#HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</a></li>
</ul>

<h2>语言语法</h2>
<h3 id="quotes">什么时候需要在命令和它们的参数中使用引号?</h3>
<p>双引号 (") 仅在 <a href="Variables.htm#Expressions">表达式</a> 中具有特殊的含义. 在其他的所有地方, 它们像普通字符一样被原义对待. 不过,当脚本启动程序或文档时,操作系统通常要求要用引号把含空格的命令行参数括起来,例如:<code>Run, Notepad.exe "C:\My Documents\Address List.txt"</code>. </p>
<h3 id="percent">什么时候需要将变量名括在百分号中?</h3>
<p>除了下面用 <strong>粗体</strong> 表示的情况外, 变量名总是要括在百分号中:</p>
<p>1) 在参数中的输入或输出变量: <code><a href="commands/StringLen.htm">StringLen</a>, <strong>OutputVar</strong>, <strong>InputVar</strong></code><br>
  2) 在赋值表达式的左侧: <code><strong>Var</strong> = 123abc</code><br>
  3) 在 <a href="commands/IfEqual.htm">传统 (非表达式) if 语句</a> 的左侧: <code>If <strong>Var1</strong> &lt; %Var2%</code><br>
4) 在<a href="Variables.htm#Expressions">表达式</a> 中的任意位置. 例如:</p>
<pre>If (<strong>Var1</strong> &lt;&gt; <strong>Var2</strong>)
    <strong>Var1 <a href="commands/SetExpression.htm">:=</a> Var2</strong> + 100</pre>
<h3 id="esc">什么时候应该对百分号和逗号进行 <a href="commands/_EscapeChar.htm">转义</a>?</h3>
<p>原义的百分号必须在它们前面加重音符/反引号进行 <a href="commands/_EscapeChar.htm">转义</a>. 例如: <code>MsgBox The current percentage is 25`%.</code> 原义的逗号也必须进行转义 (<code>`,</code>), 除非在 <a href="commands/MsgBox.htm">MsgBox</a> 或任何命令的最后一个参数 (在这种情况下可以使用重音符但不是必须的) 使用时.</p>
<p> 在 <a href="Variables.htm#Expressions">表达式</a> 中逗号或百分号括在引号中时, 可以使用这样重音符但不是必须的. 例如:<code>Var := &quot;15%&quot;</code>. </p>

<h2>一般故障排查</h2>
<h3 id="install">如果 AutoHotkey 无法安装,我该怎么办?</h3>
<p id="install-7z"><strong>7-zip 错误:</strong> 用 7-zip 或其他解压缩软件解压安装程序 EXE, 然后运行 setup.exe 或 Installer.ahk (拖拽 Installer.ahk 到 AutoHotkeyU32.exe 上即可).</p>
<p>AutoHotkey 的安装程序(exe 文件)以 7-zip 自解压格式打包,安装时尝试解压文件到用户的临时文件夹并执行编译的脚本进行安装.有时系统策略或其它原因阻止了文件的解压或执行.通常在遇到这种情况时会显示"7-zip 错误"这样一个消息. 手动解压文件到不同的目录或许能解决该问题.</p>
<p id="install-hang"><strong>安装 挂死:</strong> 如果安装窗口显示空白或不显示, 尝试下面的解决方案:</p>
<ul><li>在安装程序启动时,按住 Ctrl 或 Shift . 如果出现 UAC 提示, 按住 Ctrl 或 Shift 并点击“是或继续". 你应该能看到询问是否你要以默认选项安装的提示.</li>
<li>以<a href="Scripts.htm#install">命令行</a>选项安装. 如果你手动解压安装程序( Exe 文件), 使用 <code>setup.exe /S</code> 或 <code>AutoHotkeyU32.exe Installer.ahk /S</code>.</li>
</ul>
<p><strong>其它:</strong> 以上建议基本能解决遇到的大多数问题. 更进一步的援助, 请到论坛发帖求助.</p>

<h3 id="autoexec">为什么我脚本中的某些行总是无法执行?</h3>
<p>任何想在脚本启动时立即执行的行都应该出现在脚本的顶部, 要在首个 <a href="Hotkeys.htm">热键</a>, <a href="Hotstrings.htm">热字串</a> 或 <a href="commands/Return.htm">Return</a> 之前. 更多细节请参阅<a href="Scripts.htm#auto">自动执行部分</a>. </p>
<p>还有, 含有多行执行语句的 <a href="Hotkeys.htm">热键</a> 必须把它的首行写在热键的 <em>下面</em> 而不能在同一行. 例如:</p>
<pre>#space::  <em>; Win+空格键</em>
Run Notepad
WinWaitActive Untitled - Notepad
WinMaximize
return</pre>
<h3 id="vista">为什么我的脚本在前一个系统运行良好却无法工作于 Windows  <em>xxx</em>?</h3>
<p>因为您已经换了操作系统,很可能某些影响脚本的东西也改变了. 例如,当您换了新电脑,那么它和旧电脑有些地方是不一样的. 如果您同时更新了 AutoHotkey 的版本,那么请看看新版本的<a href="AHKL_ChangeLog.htm">更新日志</a>和<a href="Compat.htm">兼容性提示</a>以找出新旧版本的区别. </p>
<ul>
  <li>我已经升级了我的电脑或系统,现在我的脚本无法工作.</li>
  <li>当程序以管理员权限运行时,热键或热字符串不工作.</li>
  <li>系统阻止自动化操作 (例如 磁盘管理忽略 Send).</li>
</ul>
<p>当切换操作系统时, 发生的变动也许影响了你的脚本. 例如, 你的新电脑, 可能有不同的驱动或安装了其他的软件. 如果你升级了新版本的 AutoHotkey, 确认你之前使用的是哪个版本并检查<a href="AHKL_ChangeLog.htm">更新历史</a> 和 <a href="Compat.htm">脚本兼容性</a>.</p>
<p><a href="commands/SoundGet.htm">SoundGet</a>, <a href="commands/SoundSet.htm">SoundSet</a>, <a href="commands/SoundGetWaveVolume.htm">SoundGetWaveVolume</a> and <a href="commands/SoundSetWaveVolume.htm">SoundSetWaveVolume</a> 在 Vista 及之后系统的行为不同于早期版本的Windows. 尤其是, 设备的数字是不同的并且某些组件可能不可用. 依赖于音频驱动程序的行为, 必定与在 XP 时是不同的. 这 <a href="commands/SoundSet.htm#Ex">声卡分析脚本</a> 能用于找出正确的设备数字.</p>
<p>也请参考以下问题:</p>

<h3 id="uac">我该如何处理用户账户控制 (UAC) 导致的问题?</h3>
<p><a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">用户账户控制 (UAC)</a> 是导致问题的常见原因, 特别在系统由 Windows XP/Vista/7 升级到 Vista/7/8/10 时. UAC 存在于Windows Vista 及更后的系统,在新系统或新安装时默认是被激活的,并且在 Windows 8 及之后的系统中很难被禁止.</p>
<p>在默认情况下, UAC 保护 "提权" 程序 (程序以管理员权限运行) 不被非提权程序自动化,因为这将允许他们绕过安全限制. 热键也将被屏蔽, 因此, 非提权程序不能监视用于提权程序的输入.</p>
<p>UAC 也阻止了 <a href="commands/Send.htm#SendPlayDetail">SendPlay</a> 和 <a href="commands/BlockInput.htm">BlockInput</a> 的正常工作.</p>
<p>常见的解决方案如下:</p>
<ul>
  <li>选中激活安装器界面上的<em><a href="Scripts.htm#Installer_uiAccess">增加 'Run with UI Access'(以 UI Access 运行) 到上下文菜单</a></em> 这个选项. 在开始菜单中运行安装程序,该选项能被开启或关闭而不用重新安装 AutoHotkey. 该选项开启后, 右键选中的脚本文件选择 <em>Run with UI Access(以 UI Access 运行)</em>, 或者使用 <a href="Scripts.htm#cmd">命令行</a> 例如 <code>"AutoHotkeyU32_UIA.exe" "要打开的脚本文件名.ahk"</code> (可能需要包括完整路径).</li>
  <li><a href="Variables.htm#IsAdmin">以管理员权限</a>运行脚本. 注意这样的脚本中运行的任何程序也具有管理员权限. </li>
  <li>关闭<a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">用户账户控制</a>(不推荐),在 Windows 8 或之后的版本您还必须禁用"以管理员核准模式运行所有管理员(Run all administrators in Admin Approval Mode)"安全设置(也不推荐). </li>
  <li>完全禁用 UAC. 不推荐这样做, 在 Windows 8 或之后的系统中会导致系统出现一些问题,例如无法运行 Edge 和应用商店以及其安装的程序.</li>
</ul>

<h3 id="DefaultScript">我想通过托盘图标编辑脚本,但它只显示一个错误. 能在其他位置找到我的脚本吗?</h3>
<p>您必须首先修复您脚本中的错误才能找回AHK的系统托盘图标.但是首先您必须找到您的脚本.</p>
<p>请在下面的文件夹中寻找 AutoHotkey.ahk 文件:</p>
<ul>
  <li>您的 <em>Documents</em> (或 <em>My Documents</em>) 文件夹.</li>
  <li>安装 AutoHotkey 的文件夹,默认是 C:\Program Files\AutoHotkey. 如果您使用的不是安装版,那就去你在使用的 AutoHotkey.exe 的文件夹.</li>
</ul>
<p>如果您在其他目录中运行AutoHotkey, 脚本名称取决于 AutoHotkey 可执行文件的名称(不一定是 AutoHotkey.exe). 例如, 如果您运行的是 AutoHotkeyU32.exe, 那么请查找 AutoHotkeyU32.ahk. 注意,有可能您的系统配置为 ".ahk" 是隐藏文件, 但是文件一定有类似这样的图标 <img src="static/ahkfile16.png" alt="[H]"></p>
<p>您可以随时从右键菜单中选择 <em>Edit Script</em> 来编辑AHK脚本. 如果这个右键菜单命令无效, 您还可以用记事本或其他文本编辑器来编辑.</p>
<p>如果您是从开始菜单中运行 AutoHotkey 或是直接双击 AutoHotkey.exe 来运行 (不包含任何命令行参数), 那么它会查找上述的脚本来执行. 否则, 您可以在任意位置创建一个其他名称的AHK脚本文件 (something.ahk), 然后运行AHK脚本而不是 AutoHotkey.</p>
<p>另请参阅 <a href="Scripts.htm#defaultfile">命令行参数"Script Filename"</a>和 <a href="Scripts.htm#port">AutoHotkey.exe 的可移植性</a>. </p>
<h3 id="Debug">如何查找代码中的错误并修改呢?</h3>
<p>对于简单的脚本,请参阅<a href="Scripts.htm#debug">调试脚本</a>. 要查看变量的内容,请使用 <a href="commands/MsgBox.htm">MsgBox</a> 或 <a href="commands/ToolTip.htm">ToolTip</a>. 对于复杂的脚本,请参阅<a href="Scripts.htm#idebug">交互式调试</a>. </p>
<h3 id="run">为什么 <a href="commands/Run.htm">Run</a> 命令不能启动我的游戏或程序?</h3>
<p>有些程序需要在它们自己的目录下运行 (不能确定时, 通常最好这样做). 例如:</p>
<pre>Run, %A_ProgramFiles%\Some Application\App.exe, %A_ProgramFiles%\Some Application</pre>
<p>如果你想要打开的程序位于 <code>%A_WinDir%\System32</code> 并且你是在 64 位系统中使用 32 位的AutoHotkey, <a href="https://msdn.microsoft.com/en-us/library/aa384187">File System Redirector</a> 将会产生干扰. 为避免该问题, 使用 <code>%A_WinDir%\SysNative</code> 代替; 这是一个仅在64位系统上运行的32位程序可见的虚拟目录.</p>

<h3 id="games">为什么在某些游戏中 <a href="Hotstrings.htm">热字串</a>, <a href="commands/Send.htm">Send</a> 和 <a href="commands/Click.htm">Click</a> 不起作用?</h3>
<p>一些游戏禁止 AHK 发送键击和点击或获取像素颜色. </p>
<p>有一些替代方法,请试试下面提及的方案. 如果这些都无效,那么 AHK 可能不适用于您的游戏. 一些游戏含有防止反破解和作弊的措施,如 GameGuard 和 Hackshield. 如果是,则 AutoHotkey 很可能无法用于该游戏. </p>
<ul>
  <li>
  <p>通过 <a href="commands/Send.htm#SendPlay">SendPlay</a> 命令,<a href="commands/SendMode.htm">SendMode Play</a> 或 <a href="Hotstrings.htm">热字串选项 SP</a> 使用 SendPlay. </p>
  <pre>SendPlay, abc</pre>
  <pre>SendMode, Play
Send, abc</pre>
  <pre>:SP:btw::by the way

<em>; or</em>

#Hotstring SP
::btw::by the way</pre>
  <p>注: SendPlay 在启用了用户账户控制的 Windows Vista 或更高版本中可能没有效果,即使以管理员运行脚本. </p>
  </li>
  <li>
  <p>使用 <a href="commands/SetKeyDelay.htm">SetKeyDelay</a> 增加延迟. 例如:</p>
  <pre>SetKeyDelay, 0, 50
SetKeyDelay, 0, 50, Play</pre>
  </li>
  <li>
  <p>试试 <a href="commands/ControlSend.htm">ControlSend</a>,在其他 Send 模式无效时它可能行:</p>
  <pre>ControlSend,, abc, game_title</pre>
  </li>
  <li>
  <p>试试在多种发送方式中使用按键的按下和弹起事件: </p>
  <pre>Send {KEY down}{KEY up}</pre>
  </li>
  <li>
  <p>试试在按键的按下事件和弹起事件之间使用 <a href="commands/ControlSend.htm">Sleep</a>:</p>
  <pre>Send {KEY down}
Sleep 10 <em>; 试试不同的毫秒数</em>
Send {KEY Up}</pre>
  </li>
</ul>
<h3 id="perf">如何在玩游戏或平时 CPU 高负荷运行时改善性能?</h3>
<p>如果脚本中的 <a href="Hotkeys.htm">热键</a>, <a href="commands/Click.htm">鼠标点击</a>, 或 <a href="commands/Send.htm">Sends</a> 在 CPU 高负荷运行时明显比正常情况下要慢, 提高脚本程序的优先级或许会有帮助. 要提高脚本进程的优先级, 在脚本开始的部分写入下面的行:</p>
<pre><a href="commands/Process.htm">Process</a>, Priority, , High</pre>
<h3 id="Virus">我的杀毒软件把 AutoHotkey 或编译的脚本程序标记为恶意软件.它真的含病毒吗?</h3>
<p>尽管文件被感染确实是可能的,但多数情况下这些警报都是 <em>误报</em>,这意味着防病毒程序是错误的. 一个常见的建议是将文件上载到在线服务，例如 <a href="https://www.virustotal.com/">virustotal</a> 或 <a href="https://virusscan.jotti.org/">Jotti</a> 看看其他杀毒软件的查杀结果.如果有疑问，您可以将该文件发送给您的杀毒软件供应商确认. 这也可能有助于我们和其他AutoHotkey用户, 当供应商确认这是误报和改善他们的产品与AutoHotkey的兼容性.</p>
<p>对于已压缩的编译脚本来说，误报可能更为常见, 例如使用 UPX (AutoHotkey 1.0 默认,AutoHotkey 1.1 取消) 或 MPRESS (AutoHotkey 1.1 可选).AutoHotkey 安装时不带有压缩程序, 编译脚本时也默认不压缩.</p>

<h2>常见任务</h2>

<h3 id="Download">我可以在哪里找到官方发行版或更旧的版本?</h3>
<p>访问 <a href="https://autohotkey.com/download/">AutoHotkey 下载页面</a>.</p>
<h3 id="USB">可以在 USB 驱动器中运行 AHK 代码吗 ?</h3>
<p>查看 <a href="Scripts.htm#port">AutoHotkey.exe 的可移植性</a>. 注意如果你要自动包含库函数, AutoHotkey.exe 和 Lib 文件夹必须位于 Ahk2Exe.exe 上一级目录中 (例如 \AutoHotkey.exe 相对 \Compiler\Ahk2Exe.exe). 另外注意 Ahk2Exe 设置保存在下面的注册表键中: <code>HKEY_CURRENT_USER\Software\AutoHotkey\Ahk2Exe</code>.</p>
<h3 id="output">如何获取命令行操作的输出?</h3>
<p>测试表明对于文件缓存, 在相对小的输出时临时文件会比较快. 实际中, 如果文件在使用后立即被删除，它通常不会写入磁盘. 例如:</p>
<pre><a href="commands/Run.htm">RunWait</a> %comspec% /c dir &gt; C:\My Temp File.txt
FileRead, VarToContainContents, C:\My Temp File.txt
FileDelete, C:\My Temp File.txt</pre>
<p>避免使用临时文件 (特别是在输出比较大时), 考虑使用 <a href="commands/Run.htm">Run</a> 命令示例中展示的 <a href="commands/Run.htm#StdOut">Shell.Exec()</a> 方法.</p>
<h3 id="close">如何让一个脚本关闭, 暂停或挂起其他的脚本?</h3>
<p>首先, 这里有一个关闭其他脚本的例子:</p>
<pre>DetectHiddenWindows On  <em>; Allows a script's hidden main window to be detected.</em>
SetTitleMatchMode 2  <em>; Avoids the need to specify the full path of the file below.</em>
WinClose Script's File Name.ahk - AutoHotkey  <em>; Update this to reflect the script's name (case sensitive).</em></pre>
<p>其次 <a href="commands/Suspend.htm">suspend</a> 或 <a href="commands/Pause.htm">pause</a> 其他脚本, 用下面其中一行替换上面例子的最后一行:</p>
<pre>PostMessage, 0x111, 65305,,, Script's File Name.ahk - AutoHotkey  <em>; Suspend.</em>
PostMessage, 0x111, 65306,,, Script's File Name.ahk - AutoHotkey  <em>; Pause.</em></pre>
<h3 id="repeat">如何在不退出脚本的情况下停止重复的动作?</h3>
<p>通过按下热键来暂停或继续整个脚本, 定义热键到 <a href="commands/Pause.htm">Pause</a> 命令在下面的例子中:</p>
<pre>^!p::Pause  <em>; Press Ctrl+Alt+P to pause. Press it again to resume.</em></pre>
<p>停止 <a href="commands/Loop.htm">Loop</a> 中重复的操作, 考虑以下正常工作的例子, 热键启动和停止自己的重复动作. 换句话说, 按下热键将启动循环. 再次按下同样的热键将停止.</p>
<pre>#MaxThreadsPerHotkey 3
<strong>#z::  <em>; Win+Z hotkey (change this hotkey to suit your preferences).</em></strong>
#MaxThreadsPerHotkey 1
if KeepWinZRunning  <em>; This means an underlying <a href="misc/Threads.htm">thread</a> is already running the loop below.</em>
{
    KeepWinZRunning := false  <em>; Signal that thread's loop to stop.</em>
    return  <em>; End this thread so that the one underneath will resume and see the change made by the line above.</em>
}
<em>; Otherwise:</em>
KeepWinZRunning := true
Loop
{
    <strong><em>; The next four lines are the action you want to repeat (update them to suit your preferences):</em></strong>
    ToolTip, Press Win-Z again to stop this from flashing.
    Sleep 1000
    ToolTip
    Sleep 1000
    <strong><em>; But leave the rest below unchanged.</em></strong>
    if not KeepWinZRunning  <em>; The user signaled the loop to stop by pressing Win-Z again.</em>
        break  <em>; Break out of this loop.</em>
}
KeepWinZRunning := false  <em>; Reset in preparation for the next press of this hotkey.</em>
return</pre>
<h3 id="help">如何在任意编辑器中获取上下文相关的 AutoHotkey 命令帮助?</h3>
<p>Rajat 编写了 <a href="scripts/ContextSensitiveHelp.htm">这个脚本</a>.</p>
<h3 id="load">如何检测一个网页何时加载完毕?</h3>
<p>对于 Internet Explorer, 可能最可靠的方法是使用 DllCall 和 COM 在 <a href="http://www.autohotkey.com/forum/topic19256.html">www.autohotkey.com/forum/topic19256.html</a> 中提到的. 此外, 获取地址栏及状态栏相关内容的方法在 <a href="http://www.autohotkey.com/forum/topic19255.html">www.autohotkey.com/forum/topic19255.html</a> 中被提到.</p><p>译者注:适用于旧版程序及使用 COM_L,可能不适用于新版的程序(需修改相关代码才能适用于新版 AutoHotkey)</p>
<p><strong>旧的, 稳定性稍差的方法:</strong> 这下面的示例适用于 IE 打开大多数网页. 类似的方法可能适用于其他浏览器:</p>
<pre>Run, www.yahoo.com
MouseMove, 0, 0  <em>; Prevents the status bar from showing a mouse-hover link instead of &quot;Done&quot;.</em>
WinWait, Yahoo! - 
WinActivate 
<a href="commands/StatusBarWait.htm">StatusBarWait</a>, Done, 30
if ErrorLevel
   MsgBox The wait timed out or the window was closed. 
else 
   MsgBox The page is done loading.</pre>
<h3 id="time">如何比较或操作日期与时间?</h3>
<p><a href="commands/EnvAdd.htm">EnvAdd</a> 命令能加上或减去一定数量的天、小时、分钟或秒以 <a href="commands/FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a> 格式表示的时间. 接下来的示例从指定的时间减去 7 天: <code>EnvAdd, VarContainingTimestamp, -7, days</code>.</p>
<p>计算两个日期或时间之间的时间量, 参考 <a href="commands/EnvSub.htm">EnvSub</a>, 中的一个示例. 同时，内置变量 <a href="Variables.htm#Now">A_Now</a> 包含当前本地时间. 最后, 这里有一些内置的 <a href="Variables.htm#date">date/time 变量</a>, 也可以使用 <a href="commands/FormatTime.htm">FormatTime</a> 命令创建自定义格式的日期或时间字串.</p>
<h3 id="SendDate">如何发送当前的日期 和/或 时间?</h3>
<p>使用 <a href="commands/FormatTime.htm">FormatTime</a> 或 <a href="Variables.htm#date">内置的日期和时间的变量</a>.</p>
<h3 id="ControlSend">如何发送文本到不活跃或隐藏的窗口?</h3>
<p>使用 <a href="commands/ControlSend.htm">ControlSend</a>.</p>
<h3 id="winamp">如何控制 Winamp, 即使在它未激活时?</h3>
<p>请参阅 <a href="misc/Winamp.htm">让 Winamp 自动化</a>.</p>
<h3 id="msgbox">如何改变 <a href="commands/MsgBox.htm">MsgBox</a> 的按钮名称?</h3>
<p>这里有个 <a href="scripts/MsgBoxButtonNames.htm">例子</a>.</p>
<h3 id="DefaultEditor">如何改变默认编辑器,即通过上下文菜单或托盘图标打开的那个?</h3>
<p>在 <a href="commands/Edit.htm">Edit</a> 的示例部分可以找到能让您改变默认编辑器的脚本. </p>
<h3 id="GuiSubmit">如何保存 GUI 关联变量的内容?</h3>
<p>请使用 <a href="commands/Gui.htm#Submit">Gui Submit</a>. 例如:</p>
<pre>Gui, Add, Text,, Enter some Text and press Submit:
Gui, Add, Edit, vAssociatedVar
Gui, Add, Button,, Submit
Gui, Show
Return

ButtonSubmit:
Gui, Submit, NoHide
MsgBox, Content of the edit control: %AssociatedVar%
Return</pre>
<h3 id="GDIPlus">如何用 AHK 描绘?</h3>
<p>请参阅 tic 写的 <a href="http://www.autohotkey.com/forum/topic32238.html">GDI+ standard library</a> . 它可以通过一些基本方法方法有限的使用 Gui. </p>
<h3 id="WinWaitAction">如何在窗口出现,关闭或变成(不)活跃时执行操作?</h3>
<p>使用 <a href="commands/WinWait.htm">WinWait</a>,<a href="commands/WinWaitClose.htm">WinWaitClose</a> 或 <a href="commands/WinWaitActive.htm">WinWait[Not]Active</a>. </p>
<p>这里列出了用户自己的解决办法,例如:<a href="https://autohotkey.com/boards/viewtopic.php?f=6&t=6463">OnWin.ahk</a> 和 <a href="https://autohotkey.com/board/topic/80644-how-to-hook-on-to-shell-to-receive-its-messages/">[How to] Hook on to Shell to receive its messages</a>.</p>
<h2>热键, 热字串和重映射</h2>
<h3 id="Startup">如何让我的热键和热字串在 PC 启动时自动生效?</h3>
<p>在开始菜单中有一个 Startup "启动"文件夹.如果把脚本的快捷方式放到该文件夹,则对应的脚本会在每次启动电脑时自动运行.要创建快捷方式:</p>
<ol>
  <li>找到脚本文件后选中它, 接着按下 Control-C.</li>
  <li>右键点击开始按钮 (通常在屏幕的左下角) 并选择 &quot;浏览所有用户&quot;.</li>
  <li>定位到 Programs (程序)文件夹中的 Startup (启动)文件夹.</li>
  <li>在菜单栏中选择 <em>编辑 -&gt; 粘贴快捷方式</em> .现在启动文件夹中应该出现了该脚本的快捷方式.</li>
</ol>
<h3 id="HotMouse">我在把鼠标按钮作为热键使用时遇到问题. 能提供一些建议吗?</h3>
<p>鼠标左键和右键应该可以正常设置为热键(例如,<code>#LButton::</code> 为 Win+LeftButton 热键). 同样地,鼠标中键和<a href="KeyList.htm">鼠标滚轮</a>的转动应该可以正常地设置为热键,除非对于驱动直接控制这些按钮的鼠标. </p>
<p> 第四个按钮 (XButton1) 和第五个按钮 (XButton2) 也可以设置为热键, 如果您的鼠标驱动让系统可以 <a href="commands/KeyHistory.htm">看到</a> 这些按键的点击时. 如果它们不可见或您的鼠标除了您使用的五个按钮外还有更多的按钮, 您可以尝试配置鼠标附带的软件 (有时需要通过控制面板或开始菜单访问) 来实现当您按下其中的按钮时发送键击. 然后可以在脚本中把这样的键击设置为热键. 例如, 如果您配置第四个按钮来发送 Control+F1, 然后在脚本中通过使用 <code>^F1::</code> 您可以把这个按钮间接的设置为热键.</p>
<p>如果您有五键鼠标, 其中的第四和第五个按钮不 <a href="commands/KeyHistory.htm">可见</a>, 您可以尝试把鼠标驱动改变为 OS 自带的默认驱动. 这里假设您特殊的鼠标使用自己的驱动并且您不使用鼠标自带软件提供的功能.</p>
<h3 id="HotSymb">如何将 Tab 和空格设置为热键?</h3>
<p>使用它们的按键名称 (Tab 和 Space) 而不用它们的字符. 例如, <code>#Space</code> 为 Win+Space 而 <code>^!Tab</code> 为 Control+Alt+Tab.</p>
<h3 id="Remap">如何将按键或鼠标按钮重映射成其他键?</h3>
<p>解决的方法在 <a href="misc/Remap.htm">重映射</a> 页面说明了.</p>
<h3 id="DoublePress">如何检测按键或按钮的双击?</h3>
<p>像下面那样使用<a href="Variables.htm#h">可用于热键的内置变量</a>:</p>
<pre>~Ctrl::
    if (A_ThisHotkey = A_PriorHotkey &amp;&amp; A_TimeSincePriorHotkey &lt; 200)
        MsgBox double-press
return</pre>
<h3 id="HotContext">如何让 <a href="Hotkeys.htm">热键</a> 或 <a href="Hotstrings.htm">热字串</a> 只在特定的程序中有效? 换句话说, 在特定的窗口不活动时我想让特定的按键执行它原来的功能.</h3>
<p>首选的方法是使用 <a href="commands/_IfWinActive.htm">#IfWinActive</a>. 例如:</p>
<pre>#IfWinActive, ahk_class Notepad
^a::MsgBox You pressed Control-A while Notepad is active.
</pre>
<h3 id="HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</h3>
<p>请参考下面的例子, 其中把 Numpad0 作为前缀键:</p>
<pre>Numpad0 &amp; Numpad1::MsgBox, You pressed Numpad1 while holding down Numpad0.</pre>
<p>现在, 要让 Numpad0 在没有像上面那样用来触发热键时发送真正的 Numpad0 键击, 需要添加下面的热键:</p>
<pre> $Numpad0::Send, {Numpad0}</pre>
<p>使用前缀 $ 是为避免产生关于无效循环的警告对话框 (因为此热键 "发送了它自己"). 此外, 上述动作在 <strong>释放</strong> 此按键的时候发生.</p>
<h3 id="HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U (辅助工具管理器) 和 Win+R (运行)?</h3>
<p>这里有一些 <a href="misc/Override.htm">例子</a>.</p>
<h3 id="HotRegex">如何在热字串中使用通配符或正则表达式?</h3>
<p>使用 polyethene 写的<a href="https://github.com/polyethene/AutoHotkey-Scripts/blob/master/Hotstrings.ahk">脚本</a>(含示例). </p>
<h3 id="SpecialKey">如何使用不存在于我键盘布局中的热键?</h3>
<p>请参阅<a href="KeyList.htm#SpecialKeys">特殊按键</a>. </p>
<h3 id="HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</h3>
<p>是的. 这个 <a href="scripts/Numpad000.htm">示例脚本</a> 把 000 键设成等号键. 您可以用您想要的语句替换 <code>Send, =</code> 来改变动作. </p>
</body>
</html>
