<!DOCTYPE HTML>
<html>
<head>
<title>WinActivate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>WinActivate</h1>

<p>激活指定的窗口.</p>

<pre class="Syntax"><span class="func">WinActivate</span> <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<h3>参数</h3>
<dl>

  <dt>WinTitle</dt>
  <dd><p>窗口标题或识别目标窗口的其他条件. 请参阅 <a href="../misc/WinTitle.htm">WinTitle</a>.</p></dd>

  <dt>WinText</dt>
  <dd><p>如果使用此参数, 那么它必须是目标窗口中单个文本元素的子字符串(和内置的 Window Spy 工具显示的一样). 当 <a href="DetectHiddenText.htm">DetectHiddenText</a> 的设置为 ON 时, 那么会检测到隐藏文本元素.</p></dd>

  <dt>ExcludeTitle</dt>
  <dd><p>标题中含有此参数值的窗口将被排除.</p></dd>

  <dt>ExcludeText</dt>
  <dd><p>文本中含有此参数值的窗口将被排除.</p></dd>

</dl>

<h3>备注</h3>
<p>When an inactive window becomes active, the operating system also makes it foremost (brings it to the top of the stack). This does not occur if the window is already active.</p>
<p>如果窗口处于最小化和非激活状态, 那么会对其还原后再进行激活. 在 <span class="ver">[v1.1.20+]:</span> If <em>WinTitle</em> is the letter "A" and the other parameters are omitted, the active window is restored. <span class="ver">[v1.1.28.02+]:</span> 窗口即使已经是激活状态, 也会被还原.</p>
<p>在 60ms 的时间中, 会对目标窗口进行六次激活的尝试. 因此, 通常不需要在 WinActivate 后使用 <a href="WinWaitActive.htm">WinWaitActive</a> 或 <a href="WinActive.htm">IfWinNotActive</a>.</p>
<p>In general, if more than one window matches, the topmost matching window (typically the one most recently used) will be activated. If the window is already active, it will be kept active rather than activating any other matching window beneath it. However, if the active window is moved to the bottom of the stack with <a href="WinSet.htm#Bottom">WinSet Bottom</a>, some other window may be activated even if the active window is a match.</p>
<p><a href="WinActivateBottom.htm">WinActivateBottom</a> activates the bottommost matching window (typically the one least recently used).</p>
<p><a href="GroupActivate.htm">GroupActivate</a> activates the next window that matches criteria specified by a window group.</p>
<p><span class="ver">[v1.1.20+]:</span> 如果要激活的窗口处于隐藏状态并且 <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> 被设置为 OFF 时, 该窗口将永远不会视为一个匹配项. 相反, 只要有一个匹配窗口是可见的, 它就会被激活.</p>
<p>在激活一个窗口后立即激活其他的窗口, 在一些系统上任务栏按钮可能会闪烁(取决于操作系统和设置). 要避免此问题, 请使用 <a href="_WinActivateForce.htm">#WinActivateForce</a>.</p>
<p>窗口标题和文本是区分大小写的. 只有在打开 <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> 设置时, 才能检测到隐藏窗口.</p>
<p><strong>已知问题:</strong> 如果脚本运行在正在被远程桌面访问的计算机或服务器上, 当远程桌面客户端最小化时, WinActivate 可能会挂起. 一种解决办法是使用不需要激活窗口的命令, 如 <a href="ControlSend.htm">ControlSend</a> 和 <a href="ControlClick.htm">ControlClick</a>. 另一个可能的解决方法是在本地/客户端计算机的注册表上做如下设置:</p>
<pre><em>; 将 HKCU 改成 HKLM, 并对该系统上的所有用户生效.</em>
RegWrite REG_DWORD, HKCU, Software\Microsoft\Terminal Server Client
    , RemoteDesktop_SuppressWhenMinimized, 2</pre>

<h3>相关</h3>
<p><a href="WinActivateBottom.htm">WinActivateBottom</a>, <a href="_WinActivateForce.htm">#WinActivateForce</a>, <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>, <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a>, <a href="../misc/WinTitle.htm#LastFoundWindow">上次找到的窗口</a>, <a href="WinExist.htm">IfWinExist</a>, <a href="WinActive.htm">IfWinActive</a>, <a href="WinWaitActive.htm">WinWaitActive</a>, <a href="WinWait.htm">WinWait</a>, <a href="WinWaitClose.htm">WinWaitClose</a>, <a href="WinClose.htm">WinClose</a>, <a href="GroupActivate.htm">GroupActivate</a>, <a href="WinSet.htm">WinSet</a></p>
<h3>示例</h3>
<pre class="NoIndent">IfWinExist, Untitled - Notepad
    WinActivate <em>; 使用前面找到的窗口</em>
else
    WinActivate, Calculator</pre>

</body>
</html>
